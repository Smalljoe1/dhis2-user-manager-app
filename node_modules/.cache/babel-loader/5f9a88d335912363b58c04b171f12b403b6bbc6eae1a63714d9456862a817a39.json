{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\nongu\\\\Documents\\\\Projects\\\\dhis2-user-manager\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\n// src/App.js\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BASE_URL = \"https://emis.dhis2nigeria.org.ng/dhis/api\";\nconst HEADERS = {\n  'Content-Type': 'application/json',\n  'Authorization': 'ApiToken d2pat_DAULytLK7GUBSlfknZ6ffVxIfifC8T9c3885349470'\n};\nfunction App() {\n  _s();\n  const [users, setUsers] = useState([]);\n  const [log, setLog] = useState([]);\n  const handleFileUpload = e => {\n    const file = e.target.files[0];\n    const reader = new FileReader();\n    reader.onload = event => {\n      const data = JSON.parse(event.target.result);\n      setUsers(data);\n    };\n    reader.readAsText(file);\n  };\n  const getUserId = async username => {\n    try {\n      var _response$data$users, _response$data$users$;\n      const response = await axios.get(`${BASE_URL}/users?filter=username:eq:${username}&fields=id`, {\n        headers: HEADERS\n      });\n      return ((_response$data$users = response.data.users) === null || _response$data$users === void 0 ? void 0 : (_response$data$users$ = _response$data$users[0]) === null || _response$data$users$ === void 0 ? void 0 : _response$data$users$.id) || null;\n    } catch (error) {\n      return null;\n    }\n  };\n  const updateUser = async (user, id) => {\n    const userCopy = {\n      ...user\n    };\n    delete userCopy.password;\n    await axios.put(`${BASE_URL}/users/${id}`, userCopy, {\n      headers: HEADERS\n    });\n    setLog(log => [...log, `Updated user: ${user.username}`]);\n  };\n  const createUser = async user => {\n    try {\n      await axios.post(`${BASE_URL}/users`, user, {\n        headers: HEADERS\n      });\n      setLog(log => [...log, `Created user: ${user.username}`]);\n    } catch (error) {\n      var _error$response;\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 409) {\n        const userId = await getUserId(user.username);\n        if (userId) {\n          setLog(log => [...log, `User ${user.username} already exists. Updating...`]);\n          await updateUser(user, userId);\n        } else {\n          setLog(log => [...log, `Conflict creating user ${user.username}, and user ID not found.`]);\n        }\n      } else {\n        setLog(log => [...log, `Error creating user ${user.username}: ${error.message}`]);\n      }\n    }\n  };\n  const processUsers = async () => {\n    for (const user of users) {\n      const userId = await getUserId(user.username);\n      if (userId) {\n        await updateUser(user, userId);\n      } else {\n        await createUser(user);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: '2rem'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"DHIS2 User Manager\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      accept: \".json\",\n      onChange: handleFileUpload\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: processUsers,\n      disabled: !users.length,\n      children: \"Process Users\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: '1rem'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Logs:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n        children: log.join('\\n')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"dY1bNbGNKM7Zw9DZLnvBnnPSJSQ=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","axios","jsxDEV","_jsxDEV","BASE_URL","HEADERS","App","_s","users","setUsers","log","setLog","handleFileUpload","e","file","target","files","reader","FileReader","onload","event","data","JSON","parse","result","readAsText","getUserId","username","_response$data$users","_response$data$users$","response","get","headers","id","error","updateUser","user","userCopy","password","put","createUser","post","_error$response","status","userId","message","processUsers","style","padding","children","fileName","_jsxFileName","lineNumber","columnNumber","type","accept","onChange","onClick","disabled","length","marginTop","join","_c","$RefreshReg$"],"sources":["C:/Users/nongu/Documents/Projects/dhis2-user-manager/src/App.js"],"sourcesContent":["// src/App.js\nimport React, { useState } from 'react';\nimport axios from 'axios';\n\nconst BASE_URL = \"https://emis.dhis2nigeria.org.ng/dhis/api\";\nconst HEADERS = {\n  'Content-Type': 'application/json',\n  'Authorization': 'ApiToken d2pat_DAULytLK7GUBSlfknZ6ffVxIfifC8T9c3885349470'\n};\n\nfunction App() {\n  const [users, setUsers] = useState([]);\n  const [log, setLog] = useState([]);\n\n  const handleFileUpload = (e) => {\n    const file = e.target.files[0];\n    const reader = new FileReader();\n\n    reader.onload = event => {\n      const data = JSON.parse(event.target.result);\n      setUsers(data);\n    };\n    reader.readAsText(file);\n  };\n\n  const getUserId = async (username) => {\n    try {\n      const response = await axios.get(`${BASE_URL}/users?filter=username:eq:${username}&fields=id`, { headers: HEADERS });\n      return response.data.users?.[0]?.id || null;\n    } catch (error) {\n      return null;\n    }\n  };\n\n  const updateUser = async (user, id) => {\n    const userCopy = { ...user };\n    delete userCopy.password;\n    await axios.put(`${BASE_URL}/users/${id}`, userCopy, { headers: HEADERS });\n    setLog(log => [...log, `Updated user: ${user.username}`]);\n  };\n\n  const createUser = async (user) => {\n    try {\n      await axios.post(`${BASE_URL}/users`, user, { headers: HEADERS });\n      setLog(log => [...log, `Created user: ${user.username}`]);\n    } catch (error) {\n      if (error.response?.status === 409) {\n        const userId = await getUserId(user.username);\n        if (userId) {\n          setLog(log => [...log, `User ${user.username} already exists. Updating...`]);\n          await updateUser(user, userId);\n        } else {\n          setLog(log => [...log, `Conflict creating user ${user.username}, and user ID not found.`]);\n        }\n      } else {\n        setLog(log => [...log, `Error creating user ${user.username}: ${error.message}`]);\n      }\n    }\n  };\n\n  const processUsers = async () => {\n    for (const user of users) {\n      const userId = await getUserId(user.username);\n      if (userId) {\n        await updateUser(user, userId);\n      } else {\n        await createUser(user);\n      }\n    }\n  };\n\n  return (\n    <div style={{ padding: '2rem' }}>\n      <h2>DHIS2 User Manager</h2>\n      <input type=\"file\" accept=\".json\" onChange={handleFileUpload} />\n      <button onClick={processUsers} disabled={!users.length}>\n        Process Users\n      </button>\n      <div style={{ marginTop: '1rem' }}>\n        <h3>Logs:</h3>\n        <pre>{log.join('\\n')}</pre>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}